version: '3.9'

services:
  navigation:
    image: ghcr.io/robast-gmbh/monorepo/navigation:hagen
    environment:
      - ROS_DOMAIN_ID=0
      - UID=1000
    volumes:
      - ./start_scripts/:/start_scripts/:cached
      - /tmp/.X11-unix:/tmp/.X11-unix
      - ../../src/ros2/navigation/environment_vars.yaml:/workspace/src/navigation/environment_vars.yaml:cached
      - /dev/shm:/dev/shm
      - ../../src/ros2/navigation/nav_bringup/:/workspace/src/navigation/nav_bringup:cached
    command: /bin/sh -c "./start_scripts/nav_start.sh"
    stop_signal: SIGINT
    network_mode: "host"

  statemachine:
    image: ghcr.io/robast-gmbh/monorepo/statemachine:hagen
    environment:
      - ROS_DOMAIN_ID=0
      - UID=1000
    volumes:
      - ./start_scripts/:/start_scripts/:cached
      - /tmp/.X11-unix:/tmp/.X11-unix
      - /dev/shm:/dev/shm
      - ../../src/ros2/statemachine/drawer_sm/:/workspace/src/statemachine/drawer_sm:cached
    command: /bin/sh -c "./start_scripts/statemachine_start.sh"
    stop_signal: SIGINT
    network_mode: "host"

  hardware_nodes:
    image: ghcr.io/robast-gmbh/monorepo/hardware_nodes:hagen
    environment:
      - ROS_DOMAIN_ID=0
      - UID=1000
    volumes:
      - ./start_scripts/:/start_scripts/:cached
      - /dev/shm:/dev/shm
    command: /bin/sh -c "./start_scripts/hardware_nodes_start.sh"
    stop_signal: SIGINT
    network_mode: "host"

  rmf:
    image: ghcr.io/robast-gmbh/monorepo/rmf:hagen
    environment:
      - ROS_DOMAIN_ID=0
      - UID=1000
    volumes:
      - ./start_scripts/:/start_scripts/:cached
      - /dev/shm:/dev/shm
    command: /bin/sh -c "./start_scripts/rmf_start.sh"
    stop_signal: SIGINT
    network_mode: "host"

    backend:
      image: ghcr.io/robast-gmbh/monorepo/backend_web_deploy
      command: /bin/sh -c "python /workspace/src/main.py"
      stop_signal: SIGINT
      network_mode: "host"